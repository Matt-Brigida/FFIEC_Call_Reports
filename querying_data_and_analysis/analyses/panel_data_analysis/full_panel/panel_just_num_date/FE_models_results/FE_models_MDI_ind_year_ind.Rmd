---
title: "Test FE Models"
output: html_notebook
---

### Read in Panel Data

```{r}
library(plm)

data <- readRDS("../panel_mdi_ind_year_ind.rds")

panel <- pdata.frame(data, index = c("IDRSSD", "quarter"), drop.index=TRUE, row.names=TRUE)
```

## FE models:  T1 Leverage Ratio
### Change in $ Amount of Small Business Loans less than $100,000
```{r}
FEmodel1 <- plm(amt_CI_less_100_SB_loans_Delt ~  t1_LR_pre_2014_lagged_1_year + less_100_lagged_SB_loans_TA + ROA + NPA_TA + I(log(panel$total_assets_lagged_1_year)) + TD_TA + I(t1_LR_pre_2014_lagged_1_year * black_ind) + I(t1_LR_pre_2014_lagged_1_year * hispanic_ind) + X2002 + X2003 + X2004 + X2005 + X2006 + X2007 + X2008 + X2009 + X2010 + X2011 + X2012 + X2013 + X2014 + X2015 + X2016 + X2017, data = panel, model = "within", effect = "individual")
summary(FEmodel1)
```

### Change in $ Amount of Small Business Loans from $100,000 to $250,000

```{r}
FEmodel2 <- plm(amt_CI_100_250_SB_loans_Delt ~  t1_LR_pre_2014_lagged_1_year + X100_250_lagged_SB_loans_TA + ROA + NPA_TA + I(log(panel$total_assets_lagged_1_year)) + TD_TA + I(t1_LR_pre_2014_lagged_1_year * black_ind) + I(t1_LR_pre_2014_lagged_1_year * hispanic_ind) + X2002 + X2003 + X2004 + X2005 + X2006 + X2007 + X2008 + X2009 + X2010 + X2011 + X2012 + X2013 + X2014 + X2015 + X2016 + X2017, data = panel, model = "within", effect = "individual")
summary(FEmodel2)
```
### Change in $ Amount of Small Business Loans from $250,000 to $1,000,000

```{r}
FEmodel3 <- plm(amt_CI_250_1000_SB_loans_Delt ~  t1_LR_pre_2014_lagged_1_year + X250_1000_lagged_SB_loans_TA + ROA + NPA_TA + I(log(panel$total_assets_lagged_1_year)) + TD_TA + I(t1_LR_pre_2014_lagged_1_year * black_ind) + I(t1_LR_pre_2014_lagged_1_year * hispanic_ind) + X2002 + X2003 + X2004 + X2005 + X2006 + X2007 + X2008 + X2009 + X2010 + X2011 + X2012 + X2013 + X2014 + X2015 + X2016 + X2017, data = panel, model = "within", effect = "individual")
summary(FEmodel3)
```

## FE models:  T1 Risk-Based Capital Ratio
### Change in $ Amount of Small Business Loans less than $100,000

```{r}
FEmodel4 <- plm(amt_CI_less_100_SB_loans_Delt ~  t1_RBCR_pre_2014_lagged_1_year + less_100_lagged_SB_loans_TA + ROA + NPA_TA + I(log(panel$total_assets_lagged_1_year)) + TD_TA + I(t1_LR_pre_2014_lagged_1_year * black_ind) + I(t1_LR_pre_2014_lagged_1_year * hispanic_ind) + X2002 + X2003 + X2004 + X2005 + X2006 + X2007 + X2008 + X2009 + X2010 + X2011 + X2012 + X2013 + X2014 + X2015 + X2016 + X2017, data = panel, model = "within", effect = "individual")
summary(FEmodel4)
```

### Change in $ Amount of Small Business Loans from $100,000 to $250,000

```{r}
FEmodel2 <- plm(amt_CI_100_250_SB_loans_Delt ~  t1_RBCR_pre_2014_lagged_1_year + X100_250_lagged_SB_loans_TA + ROA + NPA_TA + I(log(panel$total_assets_lagged_1_year)) + TD_TA + I(t1_LR_pre_2014_lagged_1_year * black_ind) + I(t1_LR_pre_2014_lagged_1_year * hispanic_ind) + X2002 + X2003 + X2004 + X2005 + X2006 + X2007 + X2008 + X2009 + X2010 + X2011 + X2012 + X2013 + X2014 + X2015 + X2016 + X2017, data = panel, model = "within", effect = "individual")
summary(FEmodel2)
```

### Change in $ Amount of Small Business Loans from $250,000 to $1,000,000

```{r}
FEmodel3 <- plm(amt_CI_250_1000_SB_loans_Delt ~  t1_RBCR_pre_2014_lagged_1_year + X250_1000_lagged_SB_loans_TA + ROA + NPA_TA + I(log(panel$total_assets_lagged_1_year)) + TD_TA + I(t1_LR_pre_2014_lagged_1_year * black_ind) + I(t1_LR_pre_2014_lagged_1_year * hispanic_ind) + X2002 + X2003 + X2004 + X2005 + X2006 + X2007 + X2008 + X2009 + X2010 + X2011 + X2012 + X2013 + X2014 + X2015 + X2016 + X2017, data = panel, model = "within", effect = "individual")
summary(FEmodel3)
```
